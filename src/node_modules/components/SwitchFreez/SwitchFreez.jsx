import React, {useState, useContext, useEffect} from "react";

import {CurrentThemeContext} from 'contexts/currentTheme'
import useLocalStorage from 'hooks/useLocalStorage'

import './SwitchFreez.scss'


const SwitchFreez = (props) => {
    const {checkText, uncheckText, nameCheckbox} = props;
    const [currentThemeState, dispatch] = useContext(CurrentThemeContext);
    const [checked, setChecked] = useState(false);
    const [lang, setLang] = useLocalStorage('lang');
    const [theme, setTheme] = useLocalStorage('theme');

    const changeCheckbox = () => {
        setChecked(!checked);
        if (nameCheckbox === 'themeCheckbox') {
            if (checked) {
                dispatch({type: 'SET_LIGHT_THEME'});
                setTheme('light')
            } else {
                dispatch({type: 'SET_DARK_THEME'});
                setTheme('dark')
            }
        }

        if (nameCheckbox === 'langCheckbox') {
            if (checked) {
                dispatch({type: 'SET_LANG_RU'});
                setLang('ru')
            } else {
                dispatch({type: 'SET_LANG_EN'});
                setLang('en')
            }
        }

    };
    const handlerCheckbox = () => {
        changeCheckbox()
    };

    useEffect(() => {
        if (nameCheckbox === 'themeCheckbox') {
            setChecked(localStorage.getItem('theme') === 'dark')
        }
        if (nameCheckbox === 'langCheckbox') {
            setChecked(localStorage.getItem('lang') === 'en')
        }
    }, [nameCheckbox])

    return (
        <div className={currentThemeState.isLight ? 'switchFreeezLight' : 'switchFreeezDark'}>
            <input type="checkbox" className='switchFreez' onChange={changeCheckbox} checked={checked}/>
            <div className={checked ? 'pseudoCheckbox checked' : 'pseudoCheckbox'} onClick={handlerCheckbox}>
                <div className='switchCheckbox'>
                    {checked ? checkText : uncheckText}
                </div>
            </div>
        </div>
    )
};
export default SwitchFreez
