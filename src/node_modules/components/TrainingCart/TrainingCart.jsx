import React, {useContext} from "react";
import {Link} from "react-router-dom";

import styles from './TrainingCart.module.scss'
import {CurrentThemeContext} from "contexts/currentTheme";
import getField from "utilities/getField";
import SinglePhoto from "components/SinglePhoto"
import {CurrentShoppingBagContext} from "contexts/currentShoppingBag";


const TrainingCart = ({data, align}) => {
    const [currentThemeState] = useContext(CurrentThemeContext);
    const [currentShoppingBagState, dispatch] = useContext(CurrentShoppingBagContext);
    const content = getField('content', data);
    const cartButtonTextBag = currentThemeState.isLang === 'ru' ? 'ДОБАВИТЬ В КОРЗИНУ' : 'ADD TO SHOPPING BAG';
    const cartButtonTextDetail = currentThemeState.isLang === 'ru' ? 'ПОДРОБНЕЕ' : 'MORE DETAILS';
    const addShoppingBag = (id) => {
        const {trainingBag} = currentShoppingBagState;
        if (!trainingBag.includes(id)) {
            dispatch({type: 'SET_TRAINING_BAG', payload: [...trainingBag, id]});
        }
    }
    return (
        <div className={`${styles.trainingCart} ${currentThemeState.isLight ? styles.light : styles.dark}`}>
            <div className={`${styles.cartItem} ${align ? styles.right : styles.left}`}>
                <div className={styles.header}>
                    <div className={styles.name}>
                        {data.logo && <div className={styles.logo}>
                            <SinglePhoto idImg={data.logo}/>
                        </div>}
                        <div className={styles.nameText}>
                            {data['service-name']}
                        </div>
                    </div>
                    <div className={styles.price}>
                        {data.price} BYN
                    </div>
                </div>
                <div
                    className={`${styles.memberPriceWrapper}`}>
                    <div className={styles.memberPriceHr}>{data['service-name']}</div>
                    <div className={styles.memberPriceValue}>
                        <div className={styles.realPrice}>{data.duration}</div>
                        <div className={styles.fakePrice}>{data.duration}</div>
                    </div>
                </div>
                <div className={styles.cartContentWrapper}>
                    <ul>
                        {content.map((item, idx) => (
                            <li className={styles.cartContentItem} key={`item-${idx}`}>{item['content-item']}</li>
                        ))}
                    </ul>
                </div>
            </div>
            <div className={styles.buttonWrapper}>
                <button className={styles.cartButton}>
                    <div className={styles.textWrapper} onClick={() => addShoppingBag(data.id)}>
                        {cartButtonTextBag}
                    </div>
                </button>
                <Link to={{
                    pathname: `/training/${data.slug}`,
                    state: data
                }} className={styles.cartButton}>
                    <div className={styles.textWrapper}>
                        {cartButtonTextDetail}
                    </div>
                </Link>
            </div>

        </div>
    )
};

export default TrainingCart;
