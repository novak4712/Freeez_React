import React, {useContext, useEffect, useState} from "react";

import {CurrentThemeContext} from "contexts/currentTheme";
import styles from "./BagInfoBlock.module.scss";
import useFetch from "hooks/useFetch";


const BagInfoBlock = ({type}) => {
    const [currentThemeState] = useContext(CurrentThemeContext);
    const langTerms = currentThemeState.isLang === 'ru' ? 608 : 609;
    const langLicense = currentThemeState.isLang === 'ru' ? 610 : 611;
    const termsUrl = `/wp-json/wp/v2/terms_of_use/${langTerms}`
    const licenseUrl = `/wp-json/wp/v2/license_agreement/${langLicense}`
    const apiUrl = (type === 'terms') ? termsUrl : licenseUrl;
    const [{response, isLoading}, doFetch] = useFetch(apiUrl);
    const [isCollapse, setCollapse] = useState(false);
    let data = {};

    useEffect(() => {
        doFetch()
    }, [doFetch, langTerms, langLicense])

    const handlerClick = () => {
        setCollapse(!isCollapse)
    }

    if (response) {
        data = response;
    }
    return (
        <div
            className={`${styles.bagInfoBlockWrapper} ${currentThemeState.isLight ? styles.light : styles.dark}  ${(isCollapse) ? styles.isCollapse : styles.isNotCollapse}`}>
            <div className={styles.bagInfoBlockName} onClick={handlerClick}>
                {data.name}
                <div className={styles.bagInfoBlockNameIcon}>
                    {(isCollapse) ?
                        <svg width="20" height="20" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10.286 9.00024L13.5004 5.78587C13.6709 5.61537 13.7666 5.38412 13.7667 5.14299C13.7667 4.90187 13.6709 4.67062 13.5004 4.50012C13.3299 4.32962 13.0986 4.23383 12.8575 4.23383C12.6164 4.23383 12.3851 4.32962 12.2146 4.50012L9.00024 7.71449L5.78587 4.50012C5.61537 4.32962 5.38412 4.23383 5.143 4.23383C4.90188 4.23383 4.67063 4.32962 4.50013 4.50012C4.32963 4.67062 4.23384 4.90187 4.23384 5.14299C4.23384 5.38412 4.32963 5.61537 4.50013 5.78587L7.7145 9.00024L4.50013 12.2146C4.32962 12.3851 4.23384 12.6164 4.23384 12.8575C4.23384 13.0986 4.32962 13.3299 4.50013 13.5004C4.67063 13.6709 4.90188 13.7666 5.143 13.7666C5.38412 13.7666 5.61537 13.6709 5.78587 13.5004L9.00024 10.286L12.2146 13.5004C12.3851 13.6709 12.6164 13.7666 12.8575 13.7666C13.0986 13.7666 13.3299 13.6709 13.5004 13.5004C13.6709 13.3299 13.7667 13.0986 13.7667 12.8575C13.7667 12.6164 13.6709 12.3851 13.5004 12.2146L10.286 9.00024Z"/>
                        </svg>:
                        <svg width="14" height="8" viewBox="0 0 14 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6.98708 5.48206L12.1921 0.318462C12.2891 0.218831 12.4052 0.13936 12.5334 0.08469C12.6617 0.0300197 12.7997 0.00124303 12.9393 3.94887e-05C13.079 -0.00116405 13.2174 0.0252298 13.3467 0.0776805C13.4759 0.130131 13.5933 0.207588 13.692 0.305532C13.7907 0.403477 13.8688 0.519946 13.9217 0.648146C13.9746 0.776345 14.0012 0.913706 14 1.05221C13.9987 1.19072 13.9697 1.32761 13.9146 1.45487C13.8595 1.58214 13.7794 1.69725 13.679 1.79348L7.73051 7.69458C7.53332 7.89014 7.26591 8 6.98708 8C6.70825 8 6.44084 7.89014 6.24365 7.69458L0.295175 1.79348C0.103631 1.59674 -0.00235636 1.33324 3.9447e-05 1.05972C0.00243525 0.786214 0.113023 0.524578 0.307984 0.33117C0.502945 0.137761 0.76668 0.0280542 1.04239 0.0256776C1.31809 0.0233006 1.58371 0.128445 1.78203 0.318463L6.98708 5.48206Z"/>
                        </svg>
                    }
                </div>
            </div>
            <div className={styles.bagInfoBlockNameText} dangerouslySetInnerHTML={{__html: data.text}} />
        </div>
    )
}

export default BagInfoBlock
