import React, {useState, useContext, useEffect} from "react";

import {CurrentThemeContext} from 'contexts/currentTheme';

import styles from './ServicesItem.module.scss'
import getField from "utilities/getField";

const ServicesItem = ({data, handleClick, total, collapse}) => {
    const [currentThemeState] = useContext(CurrentThemeContext);
    const [isActive, setActive] = useState(false);
    const [isCollapse, setCollapse] = useState(false);
    const content = getField('content', data)
    const handleClickService = () => {
        handleClick(data)
        setCollapse(false)
    };
    const handleCollapseUp = () => {
        if(collapse){
            setCollapse(true)
        }

    }
    const handleCollapseDown = () => {
        if(collapse){
            setCollapse(false)
        }
    }
    useEffect(() => {
        setActive(total)
    }, [total])

    return (
        <div
            className={`${styles.serviceItemWrapper} ${currentThemeState.isLight ? styles.light : styles.dark} ${isCollapse ? styles.active : ''}`}
            onMouseEnter={handleCollapseUp} onMouseLeave={handleCollapseDown}>
            <button
                className={`${currentThemeState.isLight ? styles.servicesItemLight : styles.servicesItemDark} ${isActive ? styles.active : ''}`}
                onClick={handleClickService}>
                {data['service-name']}
                <div className={styles.servicesItemArrow}>
                    <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.37981 0H0L7.62018 10L0 20H9.37981L17 10L9.37981 0Z"
                              fill={currentThemeState.isLight ? '#EFEEF3' : '#232027'}
                              fillOpacity="0.25" className={styles.firstArrow}/>
                    </svg>
                    <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.37981 0H0L7.62018 10L0 20H9.37981L17 10L9.37981 0Z"
                              fill={currentThemeState.isLight ? '#EFEEF3' : '#232027'}
                              fillOpacity="0.35" className={styles.secondArrow}/>
                    </svg>
                    <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.37981 0H0L7.62018 10L0 20H9.37981L17 10L9.37981 0Z"
                              fill={currentThemeState.isLight ? '#EFEEF3' : '#232027'}
                              fillOpacity="0.45" className={styles.thirdArrow}/>
                    </svg>
                </div>
                <div className={styles.servicesItemCross}>
                    <svg width="20" height="20" viewBox="0 0 18 18" fill="none" className={styles.imageButton}

                         xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M10.286 9.00024L13.5004 5.78587C13.6709 5.61537 13.7666 5.38412 13.7667 5.14299C13.7667 4.90187 13.6709 4.67062 13.5004 4.50012C13.3299 4.32962 13.0986 4.23383 12.8575 4.23383C12.6164 4.23383 12.3851 4.32962 12.2146 4.50012L9.00024 7.71449L5.78587 4.50012C5.61537 4.32962 5.38412 4.23383 5.143 4.23383C4.90188 4.23383 4.67063 4.32962 4.50013 4.50012C4.32963 4.67062 4.23384 4.90187 4.23384 5.14299C4.23384 5.38412 4.32963 5.61537 4.50013 5.78587L7.7145 9.00024L4.50013 12.2146C4.32962 12.3851 4.23384 12.6164 4.23384 12.8575C4.23384 13.0986 4.32962 13.3299 4.50013 13.5004C4.67063 13.6709 4.90188 13.7666 5.143 13.7666C5.38412 13.7666 5.61537 13.6709 5.78587 13.5004L9.00024 10.286L12.2146 13.5004C12.3851 13.6709 12.6164 13.7666 12.8575 13.7666C13.0986 13.7666 13.3299 13.6709 13.5004 13.5004C13.6709 13.3299 13.7667 13.0986 13.7667 12.8575C13.7667 12.6164 13.6709 12.3851 13.5004 12.2146L10.286 9.00024Z"
                        />
                    </svg>
                </div>
            </button>
            <div className={styles.collapseCart}>
                <div className={styles.cartHeader}>
                    {data['service-name']}
                </div>
                <div className={styles.cartDuration}>
                    {data.duration}
                </div>
                <div className={styles.cartContent}>
                    <ul>
                        {content.map((item, idx) => (
                            <li className={styles.cartContentItem} key={`item-${idx}`}>{item['content-item']}</li>
                        ))}
                    </ul>
                </div>
                <div className={styles.cartPrice}>
                    <div className={styles.priceValue}>
                        {data.price} BYN
                    </div>
                </div>
            </div>
        </div>

    )
}
export default ServicesItem
