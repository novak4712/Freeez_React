import React, {useEffect, useContext} from "react";

import styles from './ServicesCart.module.scss'
import useFetch from 'hooks/useFetch';
import {CurrentThemeContext} from "contexts/currentTheme";

import getField from 'utilities/getField';

const ServicesCart = ({idCategory}) => {
    const [currentThemeState] = useContext(CurrentThemeContext);
    const apiUrl = `/wp-json/wp/v2/services?categories=${idCategory}`
    const memberPrice = currentThemeState.isLang === 'ru' ? 'членство' : 'member price';
    const cartButtonText = currentThemeState.isLang === 'ru' ? 'ДОБАВИТЬ В КОРЗИНУ' : 'ADD TO SHOPPING BAG';
    const [{response, isLoading}, doFetch] = useFetch(apiUrl)
    let data = []
    useEffect(() => {
        doFetch()
    }, [doFetch])

    if (response) {
        data = response

    }
    return (
        <React.Fragment>
            {(isLoading) ? <div>Loading...</div> :
                data.map((item) => {
                    const content = getField('content', item)
                    return (
                        <div className={`${styles.cartItemWrapper} ${currentThemeState.isLight ? styles.light : styles.dark}`} key={item.id}>
                            <div className={`${styles.cartItem} ${styles.left}`}>
                                <div className={styles.header}>
                                    <div className={styles.name}>
                                        {item['service-name']}
                                    </div>
                                    <div className={styles.duration}>
                                        {item.duration}
                                    </div>
                                    <div className={styles.price}>
                                        {item.price} BYN
                                    </div>
                                </div>
                                <div
                                    className={`${styles.memberPriceWrapper} ${item['member-price'] ? styles.viz : styles.notViz}`}>
                                    <div className={styles.memberPriceHr}>{item['service-name']}</div>
                                    <div className={styles.memberPriceText}>
                                        <div className={styles.realDuration}>{memberPrice}</div>
                                        <div className={styles.fakeDuration}>{item.duration}</div>
                                    </div>
                                    <div className={styles.memberPriceValue}>
                                        <div className={styles.realPrice}>{item['member-price']} BYN</div>
                                        <div className={styles.fakePrice}>{item.price} BYN</div>
                                    </div>
                                </div>
                                <div className={styles.cartContentWrapper}>
                                    <ul>
                                        {content.map((item, idx) => (
                                            <li className={styles.cartContentItem} key={`item-${idx}`}>{item['content-item']}</li>
                                        ))}
                                    </ul>
                                </div>
                            </div>
                            <button className={styles.cartButton}>
                                <div className={styles.textWrapper}>
                                    {cartButtonText}
                                    <div className={styles.buttonIconWrapper}>
                                        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" className={styles.buttonIcon}  xmlns="http://www.w3.org/2000/svg">
                                            <path d="M8.57143 6.42857V1.07143C8.57143 0.787268 8.45855 0.514746 8.25761 0.313814C8.05668 0.112882 7.78416 0 7.5 0C7.21584 0 6.94332 0.112882 6.74238 0.313814C6.54145 0.514746 6.42857 0.787268 6.42857 1.07143V6.42857H1.07143C0.787268 6.42857 0.514746 6.54145 0.313814 6.74238C0.112882 6.94332 0 7.21584 0 7.5C0 7.78416 0.112882 8.05668 0.313814 8.25761C0.514746 8.45855 0.787268 8.57143 1.07143 8.57143H6.42857V13.9286C6.42857 14.2127 6.54145 14.4853 6.74238 14.6862C6.94332 14.8871 7.21584 15 7.5 15C7.78416 15 8.05668 14.8871 8.25761 14.6862C8.45855 14.4853 8.57143 14.2127 8.57143 13.9286V8.57143H13.9286C14.2127 8.57143 14.4853 8.45855 14.6862 8.25761C14.8871 8.05668 15 7.78416 15 7.5C15 7.21584 14.8871 6.94332 14.6862 6.74238C14.4853 6.54145 14.2127 6.42857 13.9286 6.42857H8.57143Z" />
                                        </svg>
                                    </div>
                                </div>
                            </button>
                        </div>
                    )
                })
            }
        </React.Fragment>

    )
}
export default ServicesCart
