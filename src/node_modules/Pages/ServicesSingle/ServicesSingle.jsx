import React, {useContext, useEffect} from "react";

import {CurrentThemeContext} from "contexts/currentTheme";

import styles from './ServicesSingle.module.scss'
import PageLink from "components/PageLink";
import DescriptionCategory from "components/DescriptionCategory";
import ServicesCart from "components/ServicesCart";
import useFetch from "hooks/useFetch";

const ServiceSingle = (props) => {
    const [currentThemeState] = useContext(CurrentThemeContext);
    const lang = currentThemeState.isLang === 'ru' ? 22 : 19;
    const category = props.location.state;
    let apiUrl = `/wp-json/wp/v2/categories/${category}`;
    const [{response, isLoading}, doFetch] = useFetch(apiUrl);
    let nameCategory = '';

    useEffect(() => {
        doFetch()
    }, [doFetch, lang])

    if(response){
        nameCategory = response.name
    }

    return (
        <div className={`${styles.servicesSingleWrapper} ${currentThemeState.isLight ? styles.light : styles.dark}`}>
            <div className={styles.servicesSingle}>
                <div className={styles.servicesSingleHeader}>
                    <div className={styles.headerButton}>
                        {(isLoading) ? <div>Loading...</div> : nameCategory}
                    </div>
                </div>
                <div className={styles.servicesSingleText}>
                    <DescriptionCategory idCategory={category}/>
                </div>
                <div className={styles.servicesSingleCarts}>
                    <ServicesCart idCategory={category}/>
                </div>
            </div>
            <PageLink text='BACK' url='/services'/>
        </div>
    )
}

export default ServiceSingle;
